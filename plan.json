{
  "project": "ralph-deluxe-selfimprove",
  "branch": "main",
  "max_iterations": 20,
  "validation_strategy": "strict",
  "tasks": [
    {
      "id": "TASK-101",
      "title": "Fix existing test failures and shellcheck warnings",
      "description": "Resolve 7 failing bats tests and 3 SC2034 shellcheck warnings. The failures are: (1) SC2034 unused variables in agents.sh:169 (task_title), context.sh:234 (trim_by), context.sh:256 (over). (2) Tests 127,128,168,172 in context.bats — truncate_to_budget section parsing/trimming behavior. (3) Tests 111,113 in compaction.bats — verify_knowledge_index schema validation. (4) Test 314 in validation.bats — empty RALPH_VALIDATION_COMMANDS array with set -u causes unbound variable error. These failures prevent the orchestrator's own validation gate from passing.",
      "status": "in_progress",
      "order": 1,
      "skills": [
        "bash-conventions",
        "testing-bats"
      ],
      "needs_docs": false,
      "libraries": [],
      "acceptance_criteria": [
        "All 314+ bats tests pass (bats tests/ exits 0)",
        "shellcheck .ralph/ralph.sh .ralph/lib/*.sh exits 0 at warning level",
        "No behavior changes to the 307 currently passing tests"
      ],
      "depends_on": [],
      "retry_count": 1,
      "max_retries": 3
    },
    {
      "id": "TASK-102",
      "title": "Add --status flag for state and plan summary",
      "description": "Add a --status CLI flag to ralph.sh that prints a formatted summary of current orchestrator state (from state.json) and plan progress (from plan.json) without starting the main loop. Show iteration count, status, mode, last task ID, and counts of done/pending/failed/skipped tasks. Handle missing state.json gracefully.",
      "status": "pending",
      "order": 2,
      "skills": [
        "bash-conventions",
        "testing-bats"
      ],
      "needs_docs": false,
      "libraries": [],
      "acceptance_criteria": [
        "ralph.sh --status prints human-readable state and plan summary to stdout",
        "ralph.sh --status exits 0 without entering the main loop",
        "Handles missing state.json gracefully",
        "All existing bats tests still pass",
        "New bats tests cover basic output and edge cases"
      ],
      "depends_on": [
        "TASK-101"
      ],
      "retry_count": 0,
      "max_retries": 2
    },
    {
      "id": "TASK-103",
      "title": "Add prerequisite tool checking at startup",
      "description": "Add a check_prerequisites() function to ralph.sh that verifies required tools (jq, git, claude) exist on PATH at startup. Exit with clear error message if required tools are missing. Warn but continue if optional tools (bats, shellcheck) are missing. Call before source_libs() in main().",
      "status": "pending",
      "order": 3,
      "skills": [
        "bash-conventions",
        "testing-bats"
      ],
      "needs_docs": false,
      "libraries": [],
      "acceptance_criteria": [
        "ralph.sh exits 1 with clear error message if jq or git is not found",
        "ralph.sh warns but continues if bats or shellcheck is not on PATH",
        "check_prerequisites() is called in main() before source_libs()",
        "All existing bats tests still pass",
        "New bats tests cover missing required tool, missing optional tool, all present"
      ],
      "depends_on": [
        "TASK-101"
      ],
      "retry_count": 0,
      "max_retries": 2
    }
  ]
}
